<polymer-element name="g-mapvectorlayer" attributes="name visible reproject">
  <template>
  </template>
  <script>
  Polymer({
  	visible: true,
  	duration: 0,
  	
  	reproject: true,
  	created: function(){
  		var self = this;
  		this.data = [];
  		this.events = [{
			event:'click',
			action: function(d){
				d3.event.stopPropagation();
				d3.event.preventDefault();
				var offset = 30;
				d3.select(self.map.mapdiv).selectAll('.menu').remove();
				var location = [d3.event.offsetX -15, d3.event.offsetY -15];
				d3.select(self.map.mapdiv).append('paper-fab')
					.classed('menu', true)
					.on('click', function(){
						d3.select(self.map.mapdiv).selectAll('.menu').remove();
					})
					.attr('icon', 'create')
					.attr('mini', 'true')
					.style('position', 'absolute')
					.style('left', location[0] + 'px')
					.style('top', location[1] + 'px')
					.style('background', 'orange')
					.transition()
					.style('left', location[0] + 0 + 'px')
					.style('top', location[1] + offset + 'px')
				//Remove	
				d3.select(self.map.mapdiv).append('paper-fab')
					.classed('menu', true)
					.on('click', function(){
						console.log('Remove feature: ', d.properties.id);
					})
					.attr('icon', 'content-cut')
					.attr('mini', 'true')
					.style('position', 'absolute')
					.style('left', location[0] + 'px')
					.style('top', location[1] + 'px')
					.style('background', 'red')
					.transition()
					.style('left', location[0] + offset + 'px')
					.style('top', location[1] - offset + 'px');
				d3.select(self.map.mapdiv).append('paper-fab')
					.classed('menu', true)
					.attr('icon', 'editor:format-size')
					.attr('mini', 'true')
					.style('position', 'absolute')
					.style('left', location[0] + 'px')
					.style('top', location[1] + 'px')
					.style('background', 'green')
					.transition()
					.style('left', location[0] - offset + 'px')
					.style('top', location[1] - offset + 'px');
			}
  		}];
  	},
    attached: function(){
         var self = this;
         var map = this.parentNode.map;
         this.map = map;
         var onclick = function(d,e){
             //Added for testing
             //d3.event.stopPropagation();
             //self.map.draw({feature: d});
         }
         
         this.layer = new d3.mappu.VectorLayer(this.name,{
            visible: this.visible,
            reproject: this.reproject,
            duration: this.duration,
            events: this.events
         }).addTo(map);
         this.layer.data = this.data;
         this.layer.draw();
     },
     newdata: function(d){
        this.layer.data = d;
		this.fire('newdata');
     }
  });
  </script>
</polymer-element>